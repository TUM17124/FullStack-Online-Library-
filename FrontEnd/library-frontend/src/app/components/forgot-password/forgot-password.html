<div class="container">
  <mat-card class="card">
    <mat-card-title>Forgot Password</mat-card-title>

    <!-- Step 1: Enter Email -->
    <div *ngIf="step === 'request'">
      <p>Enter your email address and we'll send you a 6-digit reset code.</p>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Email</mat-label>
        <input matInput [(ngModel)]="email" type="email" required />
      </mat-form-field>

      <button mat-raised-button color="primary" class="full-width" (click)="requestReset()" [disabled]="isLoading">
        {{ isLoading ? 'Sending...' : 'Send Reset Code' }}
      </button>
    </div>

    <!-- Step 2: Enter Code + New Password -->
    <div *ngIf="step === 'confirm'">
      <p>A code was sent to <strong>{{ email }}</strong></p>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>6-Digit Code</mat-label>
        <input matInput [(ngModel)]="code" maxlength="6" placeholder="000000" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>New Password</mat-label>
        <input matInput [(ngModel)]="newPassword" type="password" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Confirm Password</mat-label>
        <input matInput [(ngModel)]="confirmPassword" type="password" />
      </mat-form-field>

      <button mat-raised-button color="primary" class="full-width" (click)="confirmReset()" [disabled]="isLoading">
        {{ isLoading ? 'Resetting...' : 'Reset Password' }}
      </button>

      <button mat-button color="warn" class="full-width mt-2" (click)="resendCode()" [disabled]="isLoading || resendDisabled">
        {{ isLoading ? 'Resending...' : 'Resend Code' }}
      </button>

      <button mat-button color="accent" class="full-width mt-2" (click)="backToEmail()">
        Back to email entry
      </button>
    </div>

    <p class="mt-3">
      Remember your password? <a routerLink="/login">Login here</a>
    </p>
  </mat-card>
</div>
